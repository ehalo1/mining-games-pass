<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mining Games Pass</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; padding: 24px; }
    .card { max-width: 520px; margin: 0 auto; padding: 18px; border: 1px solid #ddd; border-radius: 14px; }
    h1 { font-size: 20px; margin: 0 0 10px; }
    .muted { color: #666; font-size: 14px; }
    #qrcode { margin: 16px 0; }
    code { display:block; padding: 10px; background:#f6f6f6; border-radius:10px; overflow-wrap:anywhere; }
    .err { color: #b00020; font-weight: 600; }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
  <div class="card">
    <h1>Mining Games Pass</h1>
    <div class="muted">Show this QR code at check-in.</div>

    <div id="status" class="muted" style="margin-top:10px;"></div>
    <div id="qrcode"></div>

    <div class="muted">Backup text (if QR wonâ€™t scan):</div>
    <code id="payloadText"></code>
  </div>

  <script>
    function getPayload() {
      // Accept either #payload or ?payload=...
      const hash = (window.location.hash || "").replace(/^#/, "").trim();
      if (hash) return decodeURIComponent(hash);

      const params = new URLSearchParams(window.location.search);
      const q = params.get("p") || params.get("payload") || "";
      return decodeURIComponent(q || "").trim();
    }

    function render(payload) {
      const status = document.getElementById("status");
      const qrDiv = document.getElementById("qrcode");
      const textEl = document.getElementById("payloadText");

      qrDiv.innerHTML = "";
      textEl.textContent = "";

      if (!payload || payload.indexOf("|") === -1) {
        status.innerHTML = '<span class="err">Missing/invalid pass.</span> Open the exact link you were emailed.';
        return;
      }

      status.textContent = "Loaded pass.";
      textEl.textContent = payload;

      new QRCode(qrDiv, {
        text: payload,
        width: 280,
        height: 280,
        correctLevel: QRCode.CorrectLevel.M
      });
    }

    render(getPayload());
  </script>
</body>
</html>

